<!-- 
    ================================================================
    EXEMPLO DE INTEGRA√á√ÉO NO HTML DO CARD√ÅPIO GO BURGER
    ================================================================
    
    Este arquivo mostra EXATAMENTE onde adicionar o c√≥digo
    no HTML do card√°pio digital (https://go-burguer.netlify.app/)
-->

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GO BURGER - Card√°pio Digital</title>
    
    <!-- Seus estilos existentes -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    
    <!-- SEU CONTE√öDO EXISTENTE DO CARD√ÅPIO -->
    <div id="app">
        <!-- Cabe√ßalho, menu, produtos, etc. -->
    </div>

    <!-- SEUS SCRIPTS EXISTENTES -->
    <script src="seu-script-existente.js"></script>

    <!-- ========================================
         ADICIONE ESTES SCRIPTS AQUI (ANTES DO </body>)
         ======================================== -->

    <!-- 1. Firebase SDK (OBRIGAT√ìRIO) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <!-- 2. Script de Integra√ß√£o com Sistema PDV -->
    <script>
        /**
         * CONFIGURA√á√ÉO DO FIREBASE
         * MESMA configura√ß√£o do Sistema PDV
         */
        const firebaseConfig = {
            apiKey: "AIzaSyBqJQd0YpxjndeUDLoBIDjw7WPpE42YI6s",
            authDomain: "burgerpdv.firebaseapp.com",
            databaseURL: "https://burgerpdv-default-rtdb.firebaseio.com",
            projectId: "burgerpdv",
            storageBucket: "burgerpdv.firebasestorage.app",
            messagingSenderId: "810043325830",
            appId: "1:810043325830:web:fcbdb9de2c6330633c4007"
        };

        // Inicializar Firebase
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }

        const database = firebase.database();
        const onlineOrdersRef = database.ref('online-orders');

        /**
         * Fun√ß√£o principal: Envia pedido para o Sistema PDV
         */
        async function sendOrderToPDV(orderData) {
            try {
                console.log('üì§ Enviando pedido para o PDV...', orderData);
                
                // Valida√ß√µes
                if (!orderData.customer?.name) {
                    throw new Error('Nome do cliente √© obrigat√≥rio');
                }
                if (!orderData.customer?.phone) {
                    throw new Error('Telefone do cliente √© obrigat√≥rio');
                }
                if (!orderData.items?.length) {
                    throw new Error('O pedido deve ter pelo menos um item');
                }
                
                // Preparar pedido
                const order = {
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                    
                    customer: {
                        name: orderData.customer.name,
                        phone: orderData.customer.phone,
                        address: orderData.customer.address || '',
                        neighborhood: orderData.customer.neighborhood || '',
                        complement: orderData.customer.complement || '',
                        reference: orderData.customer.reference || ''
                    },
                    
                    items: orderData.items.map(item => ({
                        id: `item-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
                        name: item.name,
                        quantity: item.quantity || 1,
                        price: parseFloat(item.price) || 0,
                        extras: item.extras || [],
                        observations: item.observations || ''
                    })),
                    
                    subtotal: parseFloat(orderData.subtotal) || 0,
                    deliveryFee: parseFloat(orderData.deliveryFee) || 0,
                    discount: parseFloat(orderData.discount) || 0,
                    total: parseFloat(orderData.total) || 0,
                    
                    paymentMethod: orderData.paymentMethod || 'Dinheiro',
                    paymentStatus: 'pending',
                    deliveryType: orderData.deliveryType || 'delivery',
                    estimatedTime: orderData.estimatedTime || 45,
                    observations: orderData.observations || '',
                    status: 'pending',
                    receivedBySystem: false,
                    
                    metadata: {
                        platform: 'Card√°pio Digital GO BURGER',
                        url: window.location.href,
                        userAgent: navigator.userAgent,
                        screenSize: `${window.screen.width}x${window.screen.height}`
                    }
                };
                
                // Enviar para Firebase
                const newOrderRef = await onlineOrdersRef.push(order);
                const orderId = newOrderRef.key;
                
                console.log('‚úÖ Pedido enviado com sucesso! ID:', orderId);
                return orderId;
                
            } catch (error) {
                console.error('‚ùå Erro ao enviar pedido:', error);
                throw error;
            }
        }

        /**
         * Monitora status do pedido em tempo real
         */
        function watchOrderStatus(orderId, callback) {
            const orderRef = database.ref(`online-orders/${orderId}`);
            
            orderRef.on('value', (snapshot) => {
                const order = snapshot.val();
                if (order) {
                    callback(order);
                }
            });
            
            // Retornar fun√ß√£o para parar de escutar
            return () => orderRef.off();
        }

        // Expor fun√ß√µes globalmente
        window.sendOrderToPDV = sendOrderToPDV;
        window.watchOrderStatus = watchOrderStatus;

        console.log('üçî GO BURGER - Integra√ß√£o PDV carregada!');
    </script>

    <!-- 3. SEU C√ìDIGO DE CHECKOUT/FINALIZA√á√ÉO -->
    <script>
        /**
         * EXEMPLO: Modifique seu bot√£o de "Finalizar Pedido"
         */
        
        // Encontre seu bot√£o de finalizar
        const btnFinalizarPedido = document.getElementById('btn-finalizar'); // Use o ID correto
        
        if (btnFinalizarPedido) {
            btnFinalizarPedido.addEventListener('click', async function(e) {
                e.preventDefault();
                
                // COLETE OS DADOS DO SEU FORMUL√ÅRIO
                // Adapte os IDs para os seus campos
                const orderData = {
                    customer: {
                        name: document.getElementById('customer-name').value,
                        phone: document.getElementById('customer-phone').value,
                        address: document.getElementById('customer-address').value,
                        neighborhood: document.getElementById('customer-neighborhood')?.value || '',
                        complement: document.getElementById('customer-complement')?.value || '',
                        reference: document.getElementById('customer-reference')?.value || ''
                    },
                    
                    // SEU CARRINHO DE COMPRAS
                    // Adapte para sua estrutura de carrinho
                    items: window.carrinho.map(item => ({
                        name: item.nome,
                        quantity: item.quantidade,
                        price: item.preco,
                        extras: item.adicionais || [],
                        observations: item.observacoes || ''
                    })),
                    
                    // VALORES
                    subtotal: window.calcularSubtotal(), // Use sua fun√ß√£o
                    deliveryFee: window.taxaEntrega || 5.00,
                    discount: window.desconto || 0,
                    total: window.calcularTotal(), // Use sua fun√ß√£o
                    
                    // FORMA DE PAGAMENTO
                    paymentMethod: document.querySelector('input[name="payment"]:checked')?.value || 'Dinheiro',
                    
                    // TIPO DE ENTREGA
                    deliveryType: document.querySelector('input[name="delivery"]:checked')?.value || 'delivery',
                    
                    // TEMPO ESTIMADO
                    estimatedTime: 45,
                    
                    // OBSERVA√á√ïES
                    observations: document.getElementById('order-observations')?.value || ''
                };
                
                try {
                    // Desabilitar bot√£o durante envio
                    btnFinalizarPedido.disabled = true;
                    btnFinalizarPedido.textContent = '‚è≥ Enviando pedido...';
                    
                    // ENVIAR PEDIDO PARA O SISTEMA PDV
                    const orderId = await sendOrderToPDV(orderData);
                    
                    // SUCESSO! üéâ
                    alert(`‚úÖ Pedido enviado com sucesso!\n\nN√∫mero do pedido: ${orderId}\n\nVoc√™ receber√° atualiza√ß√µes em tempo real!`);
                    
                    // Limpar carrinho
                    window.carrinho = [];
                    
                    // Redirecionar para p√°gina de acompanhamento
                    // (crie esta p√°gina seguindo o exemplo na documenta√ß√£o)
                    window.location.href = `acompanhar-pedido.html?id=${orderId}`;
                    
                    // OU, se n√£o tiver p√°gina de acompanhamento, monitore aqui:
                    /*
                    watchOrderStatus(orderId, (order) => {
                        console.log('Status atualizado:', order.status);
                        
                        if (order.status === 'confirmed') {
                            // Mostrar notifica√ß√£o "Pedido confirmado!"
                        }
                    });
                    */
                    
                } catch (error) {
                    // ERRO
                    alert('‚ùå Erro ao enviar pedido:\n' + error.message);
                    console.error(error);
                    
                    // Reabilitar bot√£o
                    btnFinalizarPedido.disabled = false;
                    btnFinalizarPedado.textContent = 'Finalizar Pedido';
                }
            });
        }
    </script>

</body>
</html>

<!-- 
    ================================================================
    CHECKLIST DE INTEGRA√á√ÉO
    ================================================================
    
    ‚úÖ Adicionei Firebase SDK
    ‚úÖ Adicionei script de integra√ß√£o (sendOrderToPDV)
    ‚úÖ Modifiquei meu bot√£o de finalizar pedido
    ‚úÖ Adaptei os IDs dos campos para meus campos reais
    ‚úÖ Testei enviar um pedido
    ‚úÖ Verificar no Sistema PDV se pedido chegou
    
    ================================================================
    PR√ìXIMOS PASSOS
    ================================================================
    
    1. Criar p√°gina de acompanhamento (ver documenta√ß√£o)
    2. Configurar seguran√ßa do Firebase
    3. Testar em produ√ß√£o
    4. Treinar equipe
    
    ================================================================
    D√öVIDAS?
    ================================================================
    
    üìñ Documenta√ß√£o completa: docs/INTEGRACAO-CARDAPIO-DIGITAL.md
    üöÄ Guia r√°pido: docs/INSTALACAO-RAPIDA.md
    üí¨ WhatsApp: (66) 99912-2668
    
-->
